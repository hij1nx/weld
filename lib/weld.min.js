(function(w){if(!Object.keys){var y=!0,z="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),A=z.length,B;for(B in{toString:null})y=!1;Object.keys=function(e){if("object"!==typeof e&&"function"!==typeof e||null===e)throw new TypeError("Object.keys called on a non-object");var b=[],f;for(f in e)e.hasOwnProperty(f)&&b.push(f);if(y)for(f=0;f<A;f++){var a=z[f];e.hasOwnProperty(a)&&b.push(a)}return b}}Array.prototype.indexOf||(Array.prototype.indexOf=
function(e){if(null==this)throw new TypeError;var b=Object(this),f=b.length>>>0;if(0===f)return-1;var a=0;0<arguments.length&&(a=Number(arguments[1]),a!=a?a=0:0!=a&&Infinity!=a&&-Infinity!=a&&(a=(0<a||-1)*Math.floor(Math.abs(a))));if(a>=f)return-1;for(a=0<=a?a:Math.max(f-Math.abs(a),0);a<f;a++)if(a in b&&b[a]===e)return a;return-1});var u="undefined"===typeof console?{log:function(){}}:console,g=!1;"undefined"!==typeof process&&process.title&&(g=!0);var C=/input|select|option|button/i,D=/img/i,E=
/textarea/i,F=/yes|true|1|ok/i,r=0,G=g?"\u001b[32m ?\u001b[37m":" Success",H=g?"\u001b[31m ?\u001b[37m":" Fail",I=function(e,b){var f=e.toUpperCase();return function(a,e,p,h){u.log(x(),(g?"\u001b[37m+ ":"+ ")+f+" -","parent:",l(a)+",","element:",l(e)+",","key:",l(p)+",","value:",l(h));r+=1;if(b)return a=b(a,e,p,h),--r,u.log(x(),"+ "+e+""+(!1!==a?G:H)),a;--r;t("- OPERATION NOT FOUND: ",f)}},x=function(){for(var e=r,b="";e--;)b+=g?" \u043a\u0430  ":" |   ";return b},t=function(){var e=Array.prototype.slice.call(arguments);
u.log(x(),e.join(" "))},l=function(e){var b=e+"";return g?"false"===b||"null"===b||""===b||"undefined"===b||"undefined"===typeof e||!1===e?(""===b&&(b="(empty string)"),"\u001b[31m"+b+"\u001b[37m"):"\u001b[33m"+b+"\u001b[37m":b};w.weld=function(e,b,f){var a,g,p,h={alias:{},debug:!1,insert:!1};if(f)for(g in f)f.hasOwnProperty(g)&&(h[g]=f[g]);p=h.debug;var k={siblings:function(v,c,m,d){var a,b,e=v.children;cs=e.length;for(c.weld={parent:v,classes:c.className.split(" ")};cs--;)if(m=e[cs],m===c)cs<e.length&&
(c.weld.insertBefore=e[cs+1]),p&&t("- REMOVE - element:",l(c),"class:",l(c.className),"id:",l(c.id)),v.removeChild(c);else{d=m.className.split(" ");a=d.length;for(b=!0;a--;)if(0>c.weld.classes.indexOf(d[a])){b=!1;break}b&&(p&&t("- REMOVE - element:",l(m),"class:",l(m.className),"id:",l(m.id)),v.removeChild(m))}},traverse:function(a,c,m,d,e){var b,f,h,g=c.parentNode;~{}.toString.call(d).indexOf("Date")&&(d=d.toString());if(d.nodeType||"object"!==typeof d)k.set(a,c,m,d,e);else if(d.length&&d[0])for(g?
k.siblings(g,c,m,d):c.weld&&c.weld.parent&&(g=c.weld.parent),m=d.length,a=0;a<m;a++){p&&t("- CLONE - element:",l(c),"class:",l(c.className),"id:",l(c.id));b=c.cloneNode(!0);b.weld={};if(c.weld){f=Object.keys(c.weld);e=f.length;for(var q;e--;)q=f[e],b.weld[q]=c.weld[q]}k.traverse(g,b,a,d[a],d[a]);k.insertPrecheck(g,b,a,d[a])&&k.insert(g,b,a,d[a])}else for(f=Object.keys(d),q=f.length;q--;){var n=f[q];h=d[n];b=k.match(c,c,n,h);1<n.length&&"@"==n[0]?(b=n.substr(1),"."==b?(~{}.toString.call(d).indexOf("Date")&&
(d[n]=d[n].toString()),(d.nodeType||"object"!==typeof d[n])&&k.set(a,c,m,d[n],e)):c.setAttribute(b,d[n])):b?k.traverse(c,b,n,h,e):!1!==b&&"object"===typeof h&&0<Object.keys(h).length&&k.traverse(g,c,n,h)}},elementType:function(a,c,b,d){if(c&&(a=c.nodeName,"string"===typeof a)){if(C.test(a))return"input";if(D.test(a))return"image";if(E.test(a))return"textarea"}},map:!1,insertPrecheck:function(a,c,b,d){return!0},insert:function(a,c){c.weld&&c.weld.insertBefore?a.insertBefore(c,c.weld.insertBefore):
a.appendChild(c)},set:function(a,c,b,d,e){if(k.map&&!1===k.map(a,c,b,d,e))return!1;p&&t("- SET: value is",d.tagName);a=k.elementType(a,c,b,d);if(d&&d.nodeType){for(c.ownerDocument!==d.ownerDocument?d=c.ownerDocument.importNode(d,!0):d.parentNode&&d.parentNode.removeChild(d);c.firstChild;)c.removeChild(c.firstChild);c.appendChild(d)}else"input"===a?"select"===c.tagName.toLowerCase()?c.value=d:"checkbox"===c.type.toLowerCase()?F.test(d)?c.setAttribute("checked",!0):c.hasAttribute("checked")&&c.removeAttribute("checked"):
c.setAttribute("value",d):"image"===a?c.setAttribute("src",d):"textarea"===a?(c.textContent=d,c.value!==d&&(c.value=d)):c.textContent=d;return!0},match:function(a,c,b,d){if("@"!=b[0]){if("undefined"!==typeof h.alias[b])if("function"===typeof h.alias[b])b=h.alias[b](a,c,b,d)||b;else{if(!1===h.alias[b])return!1;b=h.alias[b]}if(b&&b.nodeType)return b;if(c){if(c.querySelector)return c.querySelector("."+b+",#"+b+',[name="'+b+'"]');a=c.getElementsByTagName("*");c=a.length;var e;for(e=0;e<c;e++)if(d=a[e],
d.id===b||d.name===b||-1<d.className.split(" ").indexOf(b))return d}}}};for(a in k)k.hasOwnProperty(a)&&(currentOp=k[a],f=h[a]||k[a],p&&(f=I(a,f)),k[a]=f);k.traverse(null,e,null,b);h.debug&&u.log(e.outerHTML)};"undefined"!==typeof w.define&&w.define.amd&&define("weld",[],function(){return window.weld})})("undefined"!==typeof process&&"undefined"!==typeof process.title?exports:window);